--Algoritm fÃ¶r att ta fram Top-10% till KAW.

SELECT p.lastname||', '||p.firstname AS helnamn, t.personid, COUNT(DISTINCT t.isi_id) AS top10
FROM(
   SELECT kaw.namn, kaw.personid, cwts.isi_id, cwts.percx5
   FROM cwts, kaw
   WHERE cwts.isi_id = kaw.isi_id
   AND cwts.percx5 > 80
   AND cwts.py BETWEEN 2004 AND 2013) AS t
LEFT JOIN persons AS p ON t.personid = p.personid
GROUP BY t.personid, helnamn